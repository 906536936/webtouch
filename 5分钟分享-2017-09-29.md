## 1.  touchstart 与 click

#### 问题背景

对于需要自适应的页面，为了在事件绑定时做到自适应，通过能力检测来判断当前可以绑定的事件类型。

```
var tap = 'ontouchstart' in window ? 'touchstart' : 'click';
wrap.addEvenListener(tap,function(){
	signUp();
});
```

对于大部分的浏览器都可适用，但是部分设备上，用户反馈无法响应点击事件，即便是最新的chrome版本，
ULS上没有报错信息。

#### 问题原因

- 由些PC 设备屏幕 为触摸屏，同时支持touchstart和click事件；
- 此类设备外接鼠标时，触发click事件，touchstart事件不会触发；

#### 解决办法

1. 均使用click事件，除了移动端300ms延迟，几乎无其他缺点。

2. 通过UA判断设备是否为移动端，再确认事件类型
	
	```
	 var tap = browser.isMobile() ? 'touchstart' : 'click';
	```
	**存在问题：** 如果给ipad系列外接键盘，同样不可行，这种情况应该极少见。


3. 全部使用click，通过tool-fastclick解决300毫秒的延迟问题

	```
	//引入fastclick
	var FastClick = require('tool-fastclick');
	//页面初始化时调用
	new FastClick(document.body);
	```

	**存在问题：** fastclick是否会有额外的坑？`tool-fastclick`已经解决了一部分坑。


4. 完全之策：呵呵

## 2. 禁止字体放大的问题

#### 问题背景

很多webview提供了调整页面字体大小的功能，导致页面布局混乱，以MobileQQ，WeiXin为主。

![](https://i.imgur.com/mhsTxBa.png)

#### 问题原因

- IOS上通过给 body 设置 -webkit-text-size-adjust属性实现
 ![](https://i.imgur.com/qlUg3fJ.png)

- Android通过给webview 设置字体的缩放来完成

![](https://i.imgur.com/oG3YQav.png)
![](https://i.imgur.com/tGTIFnz.png)

#### 解决办法

- 针对IOS，调整字体大小本身只是改变html的css属性，因此可以通过覆盖样式来控制。
	
	```
	body {
	    -webkit-text-size-adjust: 100% !important;
	}
	```
- 针对Android，由于是设置的webview容器本身的容器，因此无法通过前端来解决
- 在Android微信中，借助WeixinJSBridge 对象将网页的字体大小设置为默认大小。

	```
	(function() {
	        if (typeof WeixinJSBridge == "object" && typeof WeixinJSBridge.invoke == "function") {
	            handleFontSize();
	        } else {
	            document.addEventListener("WeixinJSBridgeReady", handleFontSize, false);
	        }
	
	        function handleFontSize() {
	            // 设置网页字体为默认大小
	            WeixinJSBridge.invoke('setFontSizeCallback', { 'fontSize' : 0 });
	            // 重写设置网页字体大小的事件
	            WeixinJSBridge.on('menu:setfont', function() {
	                WeixinJSBridge.invoke('setFontSizeCallback', { 'fontSize' : 0 });
	            });
	        }
	    })();
	```
- 在Android NN中，暂时没有对应的jsbridge存在，如果需要解决nn上的布局问题，则需要Android侧协助解决

#### 存在问题

- IOS中，可一劳永逸
- Android中，需webview提供接口来设置，目前只能在微信中实现。

#### AndroidQQ中方案

android qq中可以自定义webview显示的控件，通过在url中加入指定参数即可。见[如何定制手Q的Webview](http://wiki.open.qq.com/wiki/%E5%A6%82%E4%BD%95%E5%AE%9A%E5%88%B6%E6%89%8BQ%E7%9A%84Webview).


如：

 ![](https://i.imgur.com/zUyABtx.png)

理论上，<https://www.futu5.com/about/commissionnew?_wv=128>访问这个链接，功能菜单中不会出现调整字体大小的按钮。

但是，但是，但是，所有的参数中，就只有128隐藏字体项不生效，已提交站点反馈，未收到回应。




